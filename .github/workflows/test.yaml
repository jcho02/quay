name: CI-test
on:
  # See the documentation for more intricate event dispatch here:
  # https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions#on
  push:
    branches:
    - "!dependabot/*"
    - "*"
  pull_request:
    branches:
    - "*"

  jobs:
    cyrpess:
      name: Cypress Tests
      runs-on: ubuntu-22.04
      strategy:
        matrix:
          os: [ ubuntu20.04 ]
          architecture: [ amd64, ppc64le ]
        fail-fast: false
        max-parallel: 2   
      steps:

      - name: Checkout
        uses: actions/checkout@v3

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v2
       
      - name: Set up QEMU
        uses: docker/setup-qemu-action@v2

      - name: Install dependencies and check types on ${{ matrix.architecture }}
        run: |
          docker run --rm --platform ${{ matrix.architecture }} -v /var/run/docker.sock:/var/run/docker.sock --mount "type=bind,src=$(pwd),dst=/build" -w "/build" ubuntu:20.04 /bin/bash -ec ' \
          echo "$(pwd)"; \
          echo "$(ls -l);'     
